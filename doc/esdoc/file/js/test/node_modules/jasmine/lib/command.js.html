<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../../">
  <title data-ice="title">js/test/node_modules/jasmine/lib/command.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/abstract.js~AbstractHierarchy.html">AbstractHierarchy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Char.html">Char</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~EOL.html">EOL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Paragraph.html">Paragraph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Row.html">Row</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/container.js~Displayer.html">Displayer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/container.js~SearchMode.html">SearchMode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/container.js~SelectRange.html">SelectRange</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/container.js~SentenceContainer.html">SentenceContainer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~Directory.html">Directory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~File.html">File</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~FileList.html">FileList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~ConvertContainer.html">ConvertContainer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~ConvertView.html">ConvertView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~InputBuffer.html">InputBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~InputChar.html">InputChar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~CommandLine.html">CommandLine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~Cursor.html">Cursor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~Menu.html">Menu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~BoldDoMemory.html">BoldDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~ColorDoMemory.html">ColorDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DeleteDoMemory.html">DeleteDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DoManager.html">DoManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DoMemory.html">DoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~FontSizeDoMemory.html">FontSizeDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~ItalicDoMemory.html">ItalicDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~LineBreakDoMemory.html">LineBreakDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~PrintDoMemory.html">PrintDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ElemCreator">ElemCreator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-KeyTable">KeyTable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Util">Util</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">js/test/node_modules/jasmine/lib/command.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">var path = require(&apos;path&apos;),
    fs = require(&apos;fs&apos;);

exports = module.exports = Command;

var subCommands = {
  init: {
    description: &apos;initialize jasmine&apos;,
    action: initJasmine
  },
  examples: {
    description: &apos;install examples&apos;,
    action: installExamples
  },
  help: {
    description: &apos;show help&apos;,
    action: help,
    alias: &apos;-h&apos;
  },
  version: {
    description: &apos;show jasmine and jasmine-core versions&apos;,
    action: version,
    alias: &apos;-v&apos;
  }
};

function Command(projectBaseDir, examplesDir, print) {
  this.projectBaseDir = projectBaseDir;
  this.specDir = path.join(projectBaseDir, &apos;spec&apos;);

  var command = this;

  this.run = function(jasmine, commands) {
    setEnvironmentVariables(commands);

    var commandToRun;
    Object.keys(subCommands).forEach(function(cmd) {
      var commandObject = subCommands[cmd];
        if (commands.indexOf(cmd) &gt;= 0) {
        commandToRun = commandObject;
      } else if(commandObject.alias &amp;&amp; commands.indexOf(commandObject.alias) &gt;= 0) {
        commandToRun = commandObject;
      }
    });

    if (commandToRun) {
      commandToRun.action({jasmine: jasmine, projectBaseDir: command.projectBaseDir, specDir: command.specDir, examplesDir: examplesDir, print: print});
    } else {
      runJasmine(jasmine, parseOptions(commands));
    }
  };
}

function isFileArg(arg) {
  return arg.indexOf(&apos;--&apos;) !== 0 &amp;&amp; !isEnvironmentVariable(arg);
}

function parseOptions(argv) {
  var files = [],
      helpers = [],
      color = process.stdout.isTTY || false,
      filter,
      stopOnFailure,
      random,
      seed;

  argv.forEach(function(arg) {
    if (arg === &apos;--no-color&apos;) {
      color = false;
    } else if (arg.match(&quot;^--filter=&quot;)) {
      filter = arg.match(&quot;^--filter=(.*)&quot;)[1];
    } else if (arg.match(&quot;^--helper=&quot;)) {
      helpers.push(arg.match(&quot;^--helper=(.*)&quot;)[1]);
    } else if (arg.match(&quot;^--stop-on-failure=&quot;)) {
      stopOnFailure = arg.match(&quot;^--stop-on-failure=(.*)&quot;)[1] === &apos;true&apos;;
    } else if (arg.match(&quot;^--random=&quot;)) {
      random = arg.match(&quot;^--random=(.*)&quot;)[1] === &apos;true&apos;;
    } else if (arg.match(&quot;^--seed=&quot;)) {
      seed = arg.match(&quot;^--seed=(.*)&quot;)[1];
    } else if (isFileArg(arg)) {
      files.push(arg);
    }
  });
  return {
    color: color,
    filter: filter,
    stopOnFailure: stopOnFailure,
    helpers: helpers,
    files: files,
    random: random,
    seed: seed
  };
}

function runJasmine(jasmine, env) {
  jasmine.loadConfigFile(process.env.JASMINE_CONFIG_PATH);
  if (env.stopOnFailure !== undefined) {
    jasmine.stopSpecOnExpectationFailure(env.stopOnFailure);
  }
  if (env.seed !== undefined) {
    jasmine.seed(env.seed);
  }
  if (env.random !== undefined) {
    jasmine.randomizeTests(env.random);
  }
  if (env.helpers !== undefined &amp;&amp; env.helpers.length) {
    jasmine.addHelperFiles(env.helpers);
  }
  jasmine.showColors(env.color);
  jasmine.execute(env.files, env.filter);
}

function initJasmine(options) {
  var print = options.print;
  var specDir = options.specDir;
  makeDirStructure(path.join(specDir, &apos;support/&apos;));
  if(!fs.existsSync(path.join(specDir, &apos;support/jasmine.json&apos;))) {
    fs.writeFileSync(path.join(specDir, &apos;support/jasmine.json&apos;), fs.readFileSync(path.join(__dirname, &apos;../lib/examples/jasmine.json&apos;), &apos;utf-8&apos;));
  }
  else {
    print(&apos;spec/support/jasmine.json already exists in your project.&apos;);
  }
}

function installExamples(options) {
  var specDir = options.specDir;
  var projectBaseDir = options.projectBaseDir;
  var examplesDir = options.examplesDir;

  makeDirStructure(path.join(specDir, &apos;support&apos;));
  makeDirStructure(path.join(specDir, &apos;jasmine_examples&apos;));
  makeDirStructure(path.join(specDir, &apos;helpers&apos;, &apos;jasmine_examples&apos;));
  makeDirStructure(path.join(projectBaseDir, &apos;lib&apos;, &apos;jasmine_examples&apos;));

  copyFiles(
    path.join(examplesDir, &apos;spec&apos;, &apos;helpers&apos;, &apos;jasmine_examples&apos;),
    path.join(specDir, &apos;helpers&apos;, &apos;jasmine_examples&apos;),
    new RegExp(/[Hh]elper\.js/)
  );

  copyFiles(
    path.join(examplesDir, &apos;lib&apos;, &apos;jasmine_examples&apos;),
    path.join(projectBaseDir, &apos;lib&apos;, &apos;jasmine_examples&apos;),
    new RegExp(/\.js/)
  );

  copyFiles(
    path.join(examplesDir, &apos;spec&apos;, &apos;jasmine_examples&apos;),
    path.join(specDir, &apos;jasmine_examples&apos;),
    new RegExp(/[Ss]pec.js/)
  );
}

function help(options) {
  var print = options.print;
  print(&apos;Usage: jasmine [command] [options] [files]&apos;);
  print(&apos;&apos;);
  print(&apos;Commands:&apos;);
  Object.keys(subCommands).forEach(function(cmd) {
    var commandNameText = cmd;
    if(subCommands[cmd].alias) {
      commandNameText = commandNameText + &apos;,&apos; + subCommands[cmd].alias;
    }
    print(&apos;%s\t%s&apos;, lPad(commandNameText, 10), subCommands[cmd].description);
  });
  print(&apos;&apos;);
  print(&apos;If no command is given, jasmine specs will be run&apos;);
  print(&apos;&apos;);
  print(&apos;&apos;);

  print(&apos;Options:&apos;);
  print(&apos;%s\tturn off color in spec output&apos;, lPad(&apos;--no-color&apos;, 18));
  print(&apos;%s\tfilter specs to run only those that match the given string&apos;, lPad(&apos;--filter=&apos;, 18));
  print(&apos;%s\tload helper files that match the given string&apos;, lPad(&apos;--helper=&apos;, 18));
  print(&apos;%s\t[true|false] stop spec execution on expectation failure&apos;, lPad(&apos;--stop-on-failure=&apos;, 18));
  print(&apos;&apos;);
  print(&apos;The given arguments take precedence over options in your jasmine.json&apos;);
  print(&apos;The path to your optional jasmine.json can be configured by setting the JASMINE_CONFIG_PATH environment variable&apos;);
}

function version(options) {
  var print = options.print;
  print(&apos;jasmine v&apos; + require(&apos;../package.json&apos;).version);
  print(&apos;jasmine-core v&apos; + options.jasmine.coreVersion());
}

function lPad(str, length) {
  if (str.length &gt;= length) {
    return str;
  } else {
    return lPad(&apos; &apos; + str, length);
  }
}

function copyFiles(srcDir, destDir, pattern) {
  var srcDirFiles = fs.readdirSync(srcDir);
  srcDirFiles.forEach(function(file) {
    if (file.search(pattern) !== -1) {
      fs.writeFileSync(path.join(destDir, file), fs.readFileSync(path.join(srcDir, file)));
    }
  });
}

function makeDirStructure(absolutePath) {
  var splitPath = absolutePath.split(path.sep);
  splitPath.forEach(function(dir, index) {
    if(index &gt; 1) {
      var fullPath = path.join(splitPath.slice(0, index).join(&apos;/&apos;), dir);
      if (!fs.existsSync(fullPath)) {
        fs.mkdirSync(fullPath);
      }
    }
  });
}

function isEnvironmentVariable(command) {
  var envRegExp = /(.*)=(.*)/;
  return command.match(envRegExp);
}

function setEnvironmentVariables(commands) {
  commands.forEach(function (command) {
    var regExpMatch = isEnvironmentVariable(command);
    if(regExpMatch) {
      var key = regExpMatch[1];
      var value = regExpMatch[2];
      process.env[key] = value;
    }
  });
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
