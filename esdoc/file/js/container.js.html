<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">js/container.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/abstract.js~AbstractHierarchy.html">AbstractHierarchy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Char.html">Char</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~EOL.html">EOL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Paragraph.html">Paragraph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/character.js~Row.html">Row</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/container.js~SentenceContainer.html">SentenceContainer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~Directory.html">Directory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~File.html">File</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/filelist.js~FileList.html">FileList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~ConvertContainer.html">ConvertContainer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~ConvertView.html">ConvertView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~InputBuffer.html">InputBuffer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/input.js~InputChar.html">InputChar</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~CommandLine.html">CommandLine</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~Cursor.html">Cursor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/other-classes.js~Menu.html">Menu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~BoldDoMemory.html">BoldDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~ColorDoMemory.html">ColorDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DeleteDoMemory.html">DeleteDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DoManager.html">DoManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~DoMemory.html">DoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~FontSizeDoMemory.html">FontSizeDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~ItalicDoMemory.html">ItalicDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~LineBreakDoMemory.html">LineBreakDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/js/undo-redo.js~PrintDoMemory.html">PrintDoMemory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ElemCreator">ElemCreator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-KeyTable">KeyTable</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Util">Util</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">js/container.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;
/* global AbstractHierarchy, Paragraph, Cursor, InputBuffer, CommandLine, Menu, DoManager, Util, getSelection */
/**
 * &#x6587;&#x7AE0;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x3092;&#x8868;&#x3059;&#x30AF;&#x30E9;&#x30B9;
 */
export class SentenceContainer extends AbstractHierarchy {

    // constructor {{{
    /**
     * @param {number} userId &#x30E6;&#x30FC;&#x30B6;&#x30FC;ID
     * @param {object} [opt_data] &#x6587;&#x66F8;&#x60C5;&#x5831;&#x306E;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     * &lt;pre&gt;
     * {
     * 	&quot;filename&quot;: &quot;sampleFile&quot;,
     * 	&quot;fileId&quot;: &quot;12&quot;,
     *		&quot;saved&quot;: &quot;2016-08-23 02:13:05&quot;,
     *		&quot;userId&quot;: &quot;7&quot;,
     *		&quot;data&quot;: {
     *			&quot;conf&quot;: { // &#x6587;&#x66F8;&#x5168;&#x4F53;&#x306B;&#x95A2;&#x3059;&#x308B;&#x8A2D;&#x5B9A;&#x60C5;&#x5831;
     *				&quot;strLen&quot;: &quot;36&quot;,
     *				&quot;rowLen&quot;: &quot;42&quot;
     *			},
     *			&quot;text&quot;:[ // &#x5404;&#x6BB5;&#x843D;&#x306E;&#x60C5;&#x5831;&#x304C;&#x5165;&#x3063;&#x305F;&#x914D;&#x5217;&#x306E;&#x914D;&#x5217;
     *						[ // &#x6BB5;&#x843D;&#x306E;&#x60C5;&#x5831;&#x304C;&#x5165;&#x3063;&#x305F;&#x914D;&#x5217;
     *							[&quot;decolation-textalign-center&quot;],		 // &#x6BB5;&#x843D;&#x306E;&#x30AF;&#x30E9;&#x30B9;&#x304C;&#x6587;&#x5B57;&#x5217;&#x306E;&#x914D;&#x5217;&#x3067;&#x683C;&#x7D0D;&#x3055;&#x308C;&#x308B;
     *							[	 // &#x5404;&#x6587;&#x5B57;&#x306E;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x304C;&#x914D;&#x5217;&#x3067;&#x683C;&#x7D0D;&#x3055;&#x308C;&#x308B;
     *								{	 // &#x6587;&#x5B57;&#x3092;&#x8868;&#x3059;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     *									&quot;char&quot;:&quot;&#x3042;&quot;,
     *									&quot;decolation&quot;:[&quot;decolation-color-blue&quot;],
     *									&quot;fontSize&quot;:&quot;auto&quot;
     *								},
     *								{
     *									&quot;char&quot;:&quot;&#x3044;&quot;,
     *									&quot;decolation&quot;:[]
     *								}
     *							]
     *						],
     *						[
     *							[],
     *							[
     *								{
     *									&quot;char&quot;:&quot;&#x3044;&quot;,
     *									&quot;decolation&quot;:[&quot;decolation-color-red&quot;],
     *									&quot;fontSize&quot;:&quot;30&quot;
     *								},
     *								{
     *									&quot;char&quot;:&quot;&#x3046;&quot;,
     *									&quot;decolation&quot;:[&quot;decolation-color-red&quot;],
     *									&quot;fontSize&quot;:&quot;30&quot;
     *								}
     *							]
     *						]
     *			]
     *		}
     * }
     * &lt;/pre&gt;
     */
    constructor(userId,opt_data) {
        super(document.getElementById(&apos;sentence_container&apos;));
        if (opt_data) this.init(opt_data);
        this._userId = userId;
        this._titleElem = document.getElementById(&apos;file_title&apos;);
        this._searchInputElem = document.getElementById(&apos;search&apos;);
        this._announceElem = document.getElementById(&apos;user_info&apos;);
        this._changedElem = document.getElementById(&apos;changed&apos;);
        this.addFileTitleEvent();
        this.addSelectEvent();
        this._cursor = new Cursor(this);
        this._inputBuffer = new InputBuffer(this);
        this._fileList = new FileList(this);
        this._command = new CommandLine(this);
        this._menu = new Menu(this);
        this._doManager = new DoManager(this);

        if (!opt_data) this.newFile();
    }

    /**
     * &#x6587;&#x66F8;&#x3092;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306B;&#x5C55;&#x958B;&#x3057;&#x307E;&#x3059;
     * @param {object} data &#x6587;&#x66F8;&#x60C5;&#x5831;&#x306E;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    init(data) {
        this.empty();
        // &#x6587;&#x66F8;&#x60C5;&#x5831;
        this.filename(data.filename);
        this.fileId(data.fileId);
        this.saved(data.saved || (new Date(Date.now()).toLocaleDateString() + &apos; &apos; + new Date(Date.now()).toLocaleTimeString()).replace(/\//g,&apos;-&apos;));
        this._strLenOnRow = data.data.conf.strLen || 40; // &#xFF11;&#x884C;&#x306E;&#x6587;&#x5B57;&#x6570;
        this._rowLenOnPage = data.data.conf.rowLen || 40; // &#xFF11;&#x30DA;&#x30FC;&#x30B8;&#x306E;&#x884C;&#x6570;
        this.menu().confStrLenElem().value = this._strLenOnRow;
        this.menu().confRowLenElem().value = this._rowLenOnPage;
        // DOM&#x306E;&#x69CB;&#x7BC9;
        for (let paraData of data.data.text) {
            this.append(new Paragraph(paraData));
        }

        this.cursor().init();
        this.cordinate().resetDisplay();
        this.breakPage().printInfo();
        this.addKeydownEventListener();
        this.addWheelEventListener();
        this._doManager.reset();
        return this;
    }
    // }}}

    // --&#x53C2;&#x7167;&#x53D6;&#x5F97; {{{

    /**
     * &#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x5B50;&#x306E;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x914D;&#x5217;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {number} [opt_index] &#x53D6;&#x5F97;&#x3059;&#x308B;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     * @return {Paragraph Paragraph[]} &#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3002;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x914D;&#x5217;(&#x5B50;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;&#x7A7A;&#x306E;&#x914D;&#x5217;)
     */
    paragraphs(opt_index) {
        return this.children(opt_index);
    }

    /**
     * &#x6587;&#x7AE0;&#x5185;&#x306E;&#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Row} &#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    firstRow() {
        return this.firstChild().firstChild();
    }

    /**
     * &#x6587;&#x7AE0;&#x5185;&#x306E;&#x6700;&#x7D42;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Row} &#x6700;&#x7D42;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    lastRow() {
        return this.lastChild().lastChild();
    }

    /**
     * num&#x884C;&#x76EE;&#x306E;Row&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;&#x3002;
     *     num&#x304C;&#x8CA0;&#x306E;&#x6570;&#x306A;&#x3089;&#x6700;&#x521D;&#x306E;&#x884C;&#x3001;num&#x304C;&#x884C;&#x6570;&#x4EE5;&#x4E0A;&#x306E;&#x6570;&#x5024;&#x3067;&#x3042;&#x308C;&#x3070;&#x6700;&#x7D42;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x304C;&#x53D6;&#x5F97;&#x3055;&#x308C;&#x307E;&#x3059;
     * @param {number} num &#x53D6;&#x5F97;&#x3059;&#x308B;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     * @return {Row} &#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    row(num) {
        if (num &lt;= 0) return this.firstRow();
        let cnt = 0;
        for (let row = this.firstRow(); row; row = row.next()) {
            cnt++;
            if (cnt === num) return row;
        }
        return this.lastRow();
    }

    /**
     * num&#x30DA;&#x30FC;&#x30B8;&#x76EE;&#x306E;&#x7B2C;&#x4E00;&#x884C;&#x76EE;&#x306E;Row&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;&#x3002;
     *     num&#x304C;&#x8CA0;&#x306E;&#x6570;&#x306A;&#x3089;&#x6700;&#x521D;&#x306E;&#x884C;&#x3001;num&#x304C;&#x30DA;&#x30FC;&#x30B8;&#x6570;&#x4EE5;&#x4E0A;&#x306E;&#x6570;&#x5024;&#x3067;&#x3042;&#x308C;&#x3070;&#x6700;&#x7D42;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x304C;&#x53D6;&#x5F97;&#x3055;&#x308C;&#x307E;&#x3059;
     * @param {number} num &#x4F55;&#x30DA;&#x30FC;&#x30B8;&#x76EE;&#x304B;
     * @return {Row} &#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    pageRow(num) {
        if (num &lt;= 0) return this.firstRow();
        let cnt = 0;
        for (let row = this.firstRow(); row; row = row.next()) {
            if (row.isPageBreak()) {
                cnt++;
                if (cnt === num) return row;
            }
        }
        return this.lastRow();
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x3067;&#x6700;&#x521D;&#x306E;&#x6587;&#x5B57;(&#x3042;&#x308B;&#x3044;&#x306F;EOL)&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Char EOL} &#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x6587;&#x5B57;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    firstChar() {
        return this.firstRow().firstChild();
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x3067;&#x6700;&#x7D42;&#x6587;&#x5B57;(EOL&#x306F;&#x9664;&#x304F;)&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Char} &#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x6587;&#x5B57;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    lastChar() {
        return this.lastEOL().prevChar();
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x3067;&#x6700;&#x7D42;&#x884C;&#x306E;EOL&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {EOL} &#x6700;&#x5F8C;&#x306E;EOL
     */
    lastEOL() {
        return this.lastRow().lastChild();
    }

    /**
     * &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Cursor} &#x6587;&#x66F8;&#x5185;&#x306E;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    cursor() {
        return this._cursor;
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x5185;&#x3067;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x306E;&#x3042;&#x305F;&#x3063;&#x3066;&#x3044;&#x308B;&#x6587;&#x5B57;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Char} &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x6587;&#x5B57;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    cursorChar() {
        return this.cursor().getChar();
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x5185;&#x3067;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x306E;&#x3042;&#x308B;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Row} &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    cursorRow() {
        return this.cursorChar().row();
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x306B;&#x5165;&#x529B;&#x3059;&#x308B;&#x969B;&#x306B;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x5165;&#x529B;&#x30D0;&#x30C3;&#x30D5;&#x30A1;&#x30FC;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {InputBuffer} &#x5165;&#x529B;&#x30D0;&#x30C3;&#x30D5;&#x30A1;&#x30FC;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    inputBuffer() {
        return this._inputBuffer;
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x3092;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x30EA;&#x30B9;&#x30C8;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {FileList} &#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x30EA;&#x30B9;&#x30C8;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    fileList() {
        return this._fileList;
    }

    /**
     * &#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x30E9;&#x30A4;&#x30F3;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {CommandLine} &#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x30E9;&#x30A4;&#x30F3;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    command() {
        return this._command;
    }

    /**
     * &#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;Input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Element} &#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;
     */
    titleElem() {
        return this._titleElem;
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x8A9E;&#x53E5;&#x691C;&#x7D22;&#x3067;&#x4F7F;&#x7528;&#x3059;&#x308B;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Element} &#x8A9E;&#x53E5;&#x691C;&#x7D22;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;
     */
    searchInputElem() {
        return this._searchInputElem;
    }

    /**
     * &#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x3078;&#x306E;&#x60C5;&#x5831;&#x3092;&#x8868;&#x793A;&#x3059;&#x308B;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Element} &#x60C5;&#x5831;&#x8868;&#x793A;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;DOM&#x8981;&#x7D20;
     */
    announceElem() {
        return this._announceElem;
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x3092;&#x64CD;&#x4F5C;&#x3059;&#x308B;Menu&#x30AF;&#x30E9;&#x30B9;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Menu} &#x30E1;&#x30CB;&#x30E5;&#x30FC;&#x30D0;&#x30FC;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    menu() {
        return this._menu;
    }
    // }}}

    // --&#x5224;&#x5B9A; {{{
    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x5185;&#x306B;&#x6BB5;&#x843D;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {boolean} &#x6BB5;&#x843D;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x306A;&#x3089;true&#x3001;&#x305D;&#x3046;&#x3067;&#x306A;&#x3051;&#x308C;&#x3070;false
     */
    hasParagraph() {
        return this.hasChild();
    }

    // --&#x53C2;&#x7167;&#x64CD;&#x4F5C;

    /**
     * &#x5B50;&#x306E;&#x6700;&#x5F8C;&#x306B;paragraph&#x3092;&#x8FFD;&#x52A0;&#x3057;&#x307E;&#x3059;
     * @param {Paragraph} paragraph &#x8FFD;&#x52A0;&#x3059;&#x308B;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    pushParagraph(paragraph) {
        return this.pushChild(paragraph);
    }

    /**
     * &#x5B50;&#x306E;&#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x4F4D;&#x7F6E;&#x306B;paragraph&#x3092;&#x633F;&#x5165;&#x3057;&#x307E;&#x3059;
     * @param {number} pos &#x633F;&#x5165;&#x3059;&#x308B;&#x4F4D;&#x7F6E;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     * @param {Paragraph} paragraph &#x633F;&#x5165;&#x3059;&#x308B;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    insertParagraph(pos,paragraph) {
        return this.insertChild(pos,paragraph);
    }

    /**
     * &#x5B50;&#x304B;&#x3089;paragraph&#x3092;&#x524A;&#x9664;&#x3057;&#x307E;&#x3059;
     * @param {Paragraph} paragraph &#x524A;&#x9664;&#x3059;&#x308B;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    deleteParagraph(paragraph) {
        return this.deleteChild(paragraph);
    }//}}}

    // --Status {{{
    /**
     * &#x6587;&#x66F8;&#x306E;&#x5185;&#x5BB9;&#x3092;&#x8868;&#x3057;&#x305F;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;json&#x6587;&#x5B57;&#x5217;&#x3092;&#x4F5C;&#x6210;&#x3057;&#x307E;&#x3059;
     * @return {string} &#x6587;&#x66F8;&#x5185;&#x5BB9;&#x3092;&#x8868;&#x3059;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;json&#x6587;&#x5B57;&#x5217;
     */
    data() {
        const data = {};
        data.conf = this.menu().configueData();
        const paraArr = [];
        for (let paragraph of this.paragraphs())
            paraArr.push(paragraph.data());
        data.text = paraArr;

        return JSON.stringify(data);
    }

    /**
     * &#x30E6;&#x30FC;&#x30B6;&#x30FC;ID&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {number} &#x30E6;&#x30FC;&#x30B6;&#x30FC;ID
     */
    userId() {
        return this._userId;
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x5185;&#x306B;&#x5C55;&#x958B;&#x3057;&#x3066;&#x3044;&#x308B;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x73FE;&#x5728;&#x306E;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {string} [opt_newFilename] &#x65B0;&#x305F;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;
     * @return {SentenceContainer string} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    filename(opt_newFilename) {
        if (opt_newFilename === undefined)
            return this._filename;

        this._filename = opt_newFilename;
        this.titleElem().value = opt_newFilename;
        this.titleElem().dataset.filename = opt_newFilename;
        return this;
    }

    /**
     * &#x73FE;&#x5728;&#x306E;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x306B;&#x65B0;&#x305F;&#x306A;ID&#x3092;&#x4E0E;&#x3048;&#x308B;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x73FE;&#x5728;&#x306E;&#x30D5;&#x30A1;&#x30A4;&#x30EB;ID&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {number} [opt_newId] &#x65B0;&#x305F;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;ID
     * @return {SentenceContainer number} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x30D5;&#x30A1;&#x30A4;&#x30EB;ID(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    fileId(opt_newId) {
        if (opt_newId === undefined)
            return this._fileId;

        const newId = opt_newId;
        this._fileId = newId;
        this.titleElem().dataset.fileId = newId;
        return this;
    }

    /**
     * &#x6700;&#x7D42;&#x66F4;&#x65B0;&#x65E5;&#x6642;&#x3092;&#x8A2D;&#x5B9A;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x6700;&#x7D42;&#x66F4;&#x65B0;&#x65E5;&#x6642;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {string} [opt_newSaved] &#x65B0;&#x305F;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x6700;&#x7D42;&#x66F4;&#x65B0;&#x65E5;&#x6642;&#x306E;&#x6587;&#x5B57;&#x5217;
     * @return {SentenceContainer string} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x6700;&#x7D42;&#x66F4;&#x65B0;&#x65E5;&#x6642;&#x306E;&#x6587;&#x5B57;&#x5217;(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    saved(opt_newSaved) {
        if (opt_newSaved === undefined)
            return this._saved;

        const newSaved = opt_newSaved;
        this._saved = newSaved;
        document.getElementById(&apos;saved&apos;).textContent = newSaved;
        return this;
    }

    /**
     * &#x6700;&#x5F8C;&#x306E;&#x4FDD;&#x5B58;&#x304B;&#x3089;&#x5909;&#x66F4;&#x304C;&#x3042;&#x3063;&#x305F;&#x306E;&#x304B;&#x3069;&#x3046;&#x304B;&#x3092;&#x793A;&#x3059;&#x30DE;&#x30FC;&#x30AF;([+]&#x8A18;&#x53F7;)&#x3092;&#x8A2D;&#x5B9A;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x73FE;&#x5728;&#x8A2D;&#x5B9A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x306E;&#x304B;&#x3069;&#x3046;&#x304B;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {boolean} [opt_bl] &#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x5834;&#x5408;&#x306F;true&#x3001;&#x5916;&#x3059;&#x5834;&#x5408;&#x306F;false
     * @return {SentenceContainer boolean} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x8A2D;&#x5B9A;&#x72B6;&#x614B;&#x306E;&#x771F;&#x507D;&#x5024;(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    isChanged(opt_bl) {
        if (opt_bl === undefined)
            return this._changedElem.classList.contains(&apos;active&apos;);

        if (opt_bl === true) {
            this._changedElem.classList.add(&apos;active&apos;);
            return this;
        }
        if (opt_bl === false) {
            this._changedElem.classList.remove(&apos;active&apos;);
            return this;
        }
    }

    /**
     * &#x4E00;&#x884C;&#x306E;&#x6587;&#x5B57;&#x6570;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x73FE;&#x5728;&#x306E;&#x8A2D;&#x5B9A;&#x4E0A;&#x306E;&#x4E00;&#x884C;&#x306E;&#x6587;&#x5B57;&#x6570;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {number} [opt_newStrLen] &#x65B0;&#x305F;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x884C;&#x5185;&#x6587;&#x5B57;&#x6570;
     * @return {SentenceContainer number} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x8A2D;&#x5B9A;&#x4E0A;&#x306E;&#x884C;&#x5185;&#x6587;&#x5B57;&#x6570;(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    strLenOnRow(opt_newStrLen) {
        if (opt_newStrLen === undefined)
            return this._strLenOnRow;

        const newStrLen = opt_newStrLen;
        this._strLenOnRow = newStrLen;
        this.cordinate().checkKinsoku().changeDisplay().breakPage().printInfo();
        this.cursor().createCursorLine();
        return this;
    }

    // &#x8A2D;&#x5B9A;&#x4E0A;&#x306E;&#x30DA;&#x30FC;&#x30B8;&#x5185;&#x884C;&#x6570;
    /**
     * &#x4E00;&#x30DA;&#x30FC;&#x30B8;&#x306E;&#x884C;&#x6570;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x5F15;&#x6570;&#x7701;&#x7565;&#x3067;&#x73FE;&#x5728;&#x306E;&#x4E00;&#x30DA;&#x30FC;&#x30B8;&#x306E;&#x884C;&#x6570;&#x3092;&#x53D6;&#x5F97;&#x3057;&#x307E;&#x3059;
     * @param {number} [opt_newRowLen] &#x65B0;&#x305F;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x30DA;&#x30FC;&#x30B8;&#x5185;&#x884C;&#x6570;
     * @return {SentenceContainer number} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;(&#x5F15;&#x6570;&#x3092;&#x6E21;&#x3057;&#x305F;&#x5834;&#x5408;)&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x73FE;&#x5728;&#x306E;&#x30DA;&#x30FC;&#x30B8;&#x5185;&#x884C;&#x6570;(&#x5F15;&#x6570;&#x3092;&#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;)
     */
    rowLenOnPage(opt_newRowLen) {
        if (opt_newRowLen === undefined)
            return this._rowLenOnPage;

        const newRowLen = opt_newRowLen;
        this._rowLenOnPage = newRowLen;
        this.breakPage().printInfo();
        return this;
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x6587;&#x5B57;&#x6570;&#x3092;&#x6570;&#x3048;&#x307E;&#x3059;
     * @return {number} &#x6587;&#x66F8;&#x5185;&#x306E;&#x7DCF;&#x6587;&#x5B57;&#x6570;
     */
    countChar() {
        let cnt = 0;
        for (let paragraph of this.paragraphs())
            cnt += paragraph.countChar();
        return cnt;
    }

    // &#x5168;&#x884C;&#x6570;
    /**
     * &#x6587;&#x66F8;&#x5185;&#x884C;&#x6570;&#x3092;&#x6570;&#x3048;&#x307E;&#x3059;
     * @return {number} &#x6587;&#x66F8;&#x5185;&#x306E;&#x7DCF;&#x884C;&#x6570;
     */
    countRow() {
        let cnt = 0;
        for (let paragraph of this.paragraphs())
            cnt += paragraph.childLength();
        return cnt;
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x306E;&#x30DA;&#x30FC;&#x30B8;&#x6570;&#x3092;&#x6570;&#x3048;&#x307E;&#x3059;
     * @return {number} &#x6587;&#x66F8;&#x5185;&#x306E;&#x7DCF;&#x30DA;&#x30FC;&#x30B8;&#x6570;
     */
    countPage() {
        let cnt = 0;
        for (let row = this.firstRow(); row; row = row.next())
            if (row.isPageBreak()) cnt++;
        return cnt;
    }//}}}

    // --Style {{{

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306E;&#x6A2A;&#x5E45;&#x3092;&#x8FD4;&#x3048;&#x307E;&#x3059;&#x3002;
     *     &#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306F;&#xFF19;&#xFF10;&#x5EA6;&#x56DE;&#x8EE2;&#x3057;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;css&#x4E0A;&#x306F;&#x9AD8;&#x3055;&#x3068;&#x540C;&#x69D8;&#x3067;&#x3059;
     * @param {boolean} [opt_useCache=true] true=&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x5229;&#x7528;&#x3059;&#x308B;&#x3001;false=&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x5229;&#x7528;&#x3057;&#x306A;&#x3044;&#x3002;&#x7701;&#x7565;&#x3059;&#x308B;&#x3068;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x3067;true&#x306B;&#x306A;&#x308B;&#x306E;&#x3067;&#x3001;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x4F7F;&#x308F;&#x305A;&#x8A08;&#x7B97;&#x3057;&#x76F4;&#x3059;&#x5834;&#x5408;&#x306B;&#x306F;&#x660E;&#x793A;&#x7684;&#x306B;false&#x3092;&#x6E21;&#x3059;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;
     * @return {number} &#x81EA;&#x8EAB;&#x306E;&#x5E45;
     */
    width(opt_useCache) {
        return super.height(opt_useCache);
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306E;&#x9AD8;&#x3055;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x3002;
     *     &#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306F;&#xFF19;&#xFF10;&#x5EA6;&#x56DE;&#x8EE2;&#x3057;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;css&#x4E0A;&#x306F;&#x6A2A;&#x5E45;&#x3068;&#x540C;&#x69D8;&#x3067;&#x3059;
     * @param {boolean} [opt_useCache=true] true=&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x5229;&#x7528;&#x3059;&#x308B;&#x3001;false=&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x5229;&#x7528;&#x3057;&#x306A;&#x3044;&#x3002;&#x7701;&#x7565;&#x3059;&#x308B;&#x3068;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x3067;true&#x306B;&#x306A;&#x308B;&#x306E;&#x3067;&#x3001;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3092;&#x4F7F;&#x308F;&#x305A;&#x8A08;&#x7B97;&#x3057;&#x76F4;&#x3059;&#x5834;&#x5408;&#x306B;&#x306F;&#x660E;&#x793A;&#x7684;&#x306B;false&#x3092;&#x6E21;&#x3059;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;
     * @return {number} &#x81EA;&#x8EAB;&#x306E;&#x9AD8;&#x3055;
     */
    height(opt_useCache) {
        return super.width(opt_useCache);
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x3059;&#x3079;&#x3066;&#x306E;&#x6587;&#x5B57;&#x304B;&#x3089;&#x3001;&#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x30AF;&#x30E9;&#x30B9;&#x3092;&#x9664;&#x53BB;&#x3057;&#x307E;&#x3059;
     * @param {string} className &#x9664;&#x53BB;&#x3059;&#x308B;&#x30AF;&#x30E9;&#x30B9;&#x540D;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    removeClassFromAllChar(className) {
        for (let paragraph of this.paragraphs())
            paragraph.removeClassFromAllChar(className);
        return this;
    }

    /**
     * &#x6E21;&#x3055;&#x308C;&#x305F;&#x6587;&#x5B57;&#x5217;&#x3092;&#x672C;&#x6587;&#x5185;&#x304B;&#x3089;&#x63A2;&#x3057;&#x3001;&#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x6587;&#x5B57;&#x5217;&#x306B;search-word&#x30AF;&#x30E9;&#x30B9;&#x3092;&#x4ED8;&#x4E0E;&#x3057;&#x307E;&#x3059;&#x3002;
     *     &#x3055;&#x3089;&#x306B;&#x3001;&#x898B;&#x3064;&#x304B;&#x3063;&#x305F;&#x6587;&#x5B57;&#x5217;&#x306E;&#x5148;&#x982D;&#x6587;&#x5B57;&#x306B;search-label&#x30AF;&#x30E9;&#x30B9;&#x3092;&#x4ED8;&#x4E0E;&#x3057;&#x307E;&#x3059;
     *  @param {string} str &#x691C;&#x7D22;&#x6587;&#x5B57;&#x5217;
     *  @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    search(str) {
        for (let paragraph of this.paragraphs())
            paragraph.search(str);
        return this;
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x8A9E;&#x53E5;&#x691C;&#x7D22;&#x3092;&#x59CB;&#x3081;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    startSearchMode() {
        this.searchInputElem().classList.add(&apos;active&apos;);
        this.searchInputElem().focus();
        this.searchInputElem().value = &apos;/&apos;;
        this.removeKeydownEventListener();
        if (!this._keyupOnSearchArg) {
            this._keyupOnSearchArg = this.onKeyupOnSearchMode.bind(this);
            this.searchInputElem().addEventListener(&apos;keyup&apos;,this._keyupOnSearchArg,false);
            this.searchInputElem().addEventListener(&apos;focusin&apos;,this.onFocusinOnSearchMode.bind(this));
            this.searchInputElem().addEventListener(&apos;focusout&apos;,this.onFocusoutOnSearchMode.bind(this));
        }
        return this;
    }

    /**
     * &#x6587;&#x66F8;&#x5185;&#x8A9E;&#x53E5;&#x691C;&#x7D22;&#x3092;&#x5B8C;&#x5168;&#x306B;&#x7D42;&#x4E86;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    stopSearchMode() {
        this.addKeydownEventListener();
        this.searchInputElem().value = &apos;&apos;;
        this.searchInputElem().classList.remove(&apos;active&apos;);
        this.removeClassFromAllChar(&apos;search-label&apos;).removeClassFromAllChar(&apos;search-word&apos;);
        return this;
    }//}}}

    // selection {{{
    /**
     * &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x306B;&#x3042;&#x308B;&#x6587;&#x5B57;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x914D;&#x5217;&#x3067;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @param {boolean} [opt_bl] &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x3092;&#x89E3;&#x9664;&#x3059;&#x308B;&#x306A;&#x3089;true&#x3092;&#x6307;&#x5B9A;&#x3059;&#x308B;
     * @return {Char[]} &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x5185;&#x306B;&#x3042;&#x308B;&#x6587;&#x5B57;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x914D;&#x5217;
     */
    selectChars(opt_bl) {
        const ret = [];
        const selection = getSelection();
        if (this.selectText().length === 0)
            return ret; // rangeCount===0&#x3068;&#x3059;&#x308B;&#x3068;&#x3001;EOL&#x306E;&#x307F;&#x9078;&#x629E;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x304C;&#x3042;&#x308B;

        const selRange = selection.getRangeAt(0);
        for (let char = this.firstChar(); char; char = char.nextChar())
            if (char.isInRange(selRange)) ret.push(char);

        selRange.detach();
        if (opt_bl) selection.removeAllRanges(); // &#x9078;&#x629E;&#x3092;&#x89E3;&#x9664;&#x3059;&#x308B;
        return ret;
    }

    /**
     * &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x5185;&#x306B;&#x3042;&#x308B;&#x6587;&#x5B57;&#x5217;&#x3092;&#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x30B9;&#x30C8;&#x30EC;&#x30FC;&#x30B8;&#x306B;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    copySelectText() {
        localStorage.clipBoard = this.selectText();
        return this;
    }

    // &#x30DA;&#x30FC;&#x30B9;&#x30C8;
    /**
     * &#x30ED;&#x30FC;&#x30AB;&#x30EB;&#x30B9;&#x30C8;&#x30EC;&#x30FC;&#x30B8;&#x306B;&#x4FDD;&#x5B58;&#x3057;&#x305F;&#x6587;&#x5B57;&#x5217;&#x3092;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x304B;&#x3089;&#x633F;&#x5165;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    pasteText() {
        this.cursor().insert(localStorage.clipBoard);
        return this;
    }

    /**
     * &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x5185;&#x306B;&#x3042;&#x308B;&#x6587;&#x5B57;&#x5217;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {string} &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x5185;&#x306E;&#x6587;&#x5B57;&#x5217;
     */
    selectText() {
        const selection = getSelection();
        let ret = &apos;&apos;;
        for (let i = 0,cnt = selection.rangeCount; i &lt; cnt; i++) {
            const selRange = selection.getRangeAt(i);
            ret += selRange.toString();
        }
        return ret;
    }//}}}

    // --DOM&#x64CD;&#x4F5C;&#x95A2;&#x4FC2; {{{
    /**
     * &#x5B50;&#x3092;&#x7A7A;&#x306B;&#x3057;&#x3001;&#x5165;&#x529B;&#x30E2;&#x30FC;&#x30C9;&#x3001;&#x8A9E;&#x53E5;&#x691C;&#x7D22;&#x30E2;&#x30FC;&#x30C9;&#x306F;&#x7D42;&#x4E86;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    empty() {
        this.emptyElem();
        this.emptyChild();
        this.removeKeydownEventListener();
        this.removeWheelEventListener();
        if (this.inputBuffer().isDisplay()) {
            this.inputBuffer().empty().hide();
        }
        this.stopSearchMode();
        return this;
    }

    /**
     * &#x3053;&#x306E;&#x6587;&#x7AE0;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306E;&#x672B;&#x5C3E;&#x306B;paragraph&#x3092;&#x8FFD;&#x52A0;&#x3057;&#x307E;&#x3059;
     * @param {Paragraph} paragraph &#x8FFD;&#x52A0;&#x3059;&#x308B;&#x6BB5;&#x843D;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    append(paragraph) {
        this.elem().appendChild(paragraph.elem());
        paragraph.container(this);
        if (!this.hasParagraph()) {
            this.pushParagraph(paragraph);
            return this;
        }
        // paragraph
        this.lastChild().next(paragraph);
        paragraph.prev(this.lastChild());
        // row
        const lastRow = this.lastChild().lastChild();
        lastRow.next(paragraph.firstChild());
        paragraph.firstChild().prev(lastRow);
        // char
        const lastChar = lastRow.lastChild();
        lastChar.next(paragraph.firstChild().firstChild());
        paragraph.firstChild().firstChild().prev(lastChar);

        this.pushParagraph(paragraph);
        return this;
    }//}}}

// printInfo {{{
    /**
     * &#x6587;&#x66F8;&#x60C5;&#x5831;&#x3092;&#x8868;&#x793A;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    printInfo() {
        document.getElementById(&apos;str_pos&apos;).textContent = this.cursor().currentCharPos();
        document.getElementById(&apos;str_len&apos;).textContent = this.cursor().strLenOfRow();
        document.getElementById(&apos;row_pos&apos;).textContent = this.cursor().currentRowPos();
        document.getElementById(&apos;row_len&apos;).textContent = this.cursor().rowLenOnPage();
        document.getElementById(&apos;page_pos&apos;).textContent = this.cursor().currentPage();
        document.getElementById(&apos;page_len&apos;).textContent = this.countPage();
        return this;
    }//}}}

    // --&#x6587;&#x7AE0;&#x6574;&#x7406; {{{
    /**
     * &#x5404;&#x884C;&#x304C;&#x6307;&#x5B9A;&#x6587;&#x5B57;&#x6570;&#x3068;&#x7570;&#x306A;&#x308B;&#x6587;&#x5B57;&#x6570;&#x306A;&#x3089;&#x3001;&#x6307;&#x5B9A;&#x6587;&#x5B57;&#x6570;&#x306B;&#x5408;&#x308F;&#x305B;&#x3066;&#x6587;&#x5B57;&#x6570;&#x3092;&#x8ABF;&#x7BC0;&#x3057;&#x307E;&#x3059;&#x3002;
     *     &#x6A19;&#x6E96;&#x4EE5;&#x5916;&#x306E;&#x30D5;&#x30A9;&#x30F3;&#x30C8;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x6587;&#x5B57;&#x304C;&#x3042;&#x308C;&#x3070;&#x30D5;&#x30A9;&#x30F3;&#x30C8;&#x30B5;&#x30A4;&#x30BA;&#x306B;&#x5408;&#x308F;&#x305B;&#x3066;&#x6587;&#x5B57;&#x6570;&#x306F;&#x8ABF;&#x6574;&#x3055;&#x308C;&#x307E;&#x3059;&#x3002;
     *     &#x307E;&#x305F;&#x3001;&#x7A7A;&#x6BB5;&#x843D;&#x4EE5;&#x5916;&#x306B;&#x7A7A;&#x884C;&#x304C;&#x3042;&#x308C;&#x3070;&#x524A;&#x9664;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    cordinate() {
        for (let paragraph of this.paragraphs())
            paragraph.cordinate();
        return this;
    }

    /**
     * &#x7981;&#x5247;&#x51E6;&#x7406;&#x3092;&#x884C;&#x3044;&#x307E;&#x3059;&#x3002;
     *     &#x5404;&#x884C;&#x306E;&#x6587;&#x5B57;&#x6570;&#x3078;&#x306E;&#x5909;&#x5316;&#x304C;&#x4F34;&#x3046;&#x305F;&#x3081;&#x3001;cordinate()&#x306E;&#x5F8C;&#x306B;&#x5B9F;&#x884C;&#x3057;&#x3066;&#x304F;&#x3060;&#x3055;&#x3044;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    checkKinsoku() {
        for (let paragraph of this.paragraphs())
            paragraph.checkKinsoku();
        return this;
    }//}}}

    // &#x6539;&#x30DA;&#x30FC;&#x30B8; {{{
    /**
     * &#x30DA;&#x30FC;&#x30B8;&#x306E;&#x6700;&#x521D;&#x306E;&#x884C;&#x3068;&#x6700;&#x7D42;&#x884C;&#x306B;&#x76EE;&#x5370;&#x3068;&#x306A;&#x308B;&#x30AF;&#x30E9;&#x30B9;&#x3092;&#x4E0E;&#x3048;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    breakPage() {
        const pageNum = this.rowLenOnPage();
        // page-break
        let cnt1 = 0;
        for (let paragraph of this.paragraphs()) {
            for (let row of paragraph.rows()) {
                if (cnt1 === 0 || cnt1 % pageNum === 0) // &#xFF11;&#x884C;&#x76EE;&#x3068;pageNum&#x306E;&#x500D;&#x6570;&#x884C;&#x76EE;
                    row.addClass(&apos;page-break&apos;);
                else
                    row.removeClass(&apos;page-break&apos;);
                cnt1++;
            }
        }
        // page-last-row
        let cnt2 = 0;
        const lastRow = this.countRow() -1;
        for (let paragraph of this.paragraphs()) {
            for (let row of paragraph.rows()) {
                if ((cnt2 + 1) % pageNum === 0 || cnt2 === lastRow) // (pageNum&#x306E;&#x500D;&#x6570;-1)&#x884C;&#x76EE;&#x3068;&#x6700;&#x7D42;&#x884C;
                    row.addClass(&apos;page-last-row&apos;);
                else
                    row.removeClass(&apos;page-last-row&apos;);
                cnt2++;
            }
        }
        return this;
    }//}}}

// announce {{{
    /**
     * &#x30E6;&#x30FC;&#x30B6;&#x30FC;&#x3078;&#x306E;&#x60C5;&#x5831;&#x3092;&#x8868;&#x793A;&#x3057;&#x307E;&#x3059;
     * @param {string} str &#x8868;&#x793A;&#x3059;&#x308B;&#x60C5;&#x5831;
     * @param {string} [opt_color=&apos;black&apos;] &#x9ED2;&#x6587;&#x5B57;&#x4EE5;&#x5916;&#x306E;&#x6587;&#x5B57;&#x8272;&#x3067;&#x8868;&#x793A;&#x3059;&#x308B;&#x5834;&#x5408;&#x306B;&#x8272;&#x540D;&#x3092;&#x6307;&#x5B9A;&#x3059;&#x308B;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    announce(str,opt_color) {
        this.announceElem().textContent = str;
        if (opt_color)
            this.announceElem().style.color = opt_color;
        else
            this.announceElem().style.color = &apos;&apos;;
        return this;
    }//}}}

    // --&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x64CD;&#x4F5C; {{{
    /**
     * &#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3092;&#x958B;&#x304D;&#x307E;&#x3059;(&#x975E;&#x540C;&#x671F;&#x901A;&#x4FE1;)
     * @param {number} fileId &#x958B;&#x304F;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x306E;ID
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @see ../WEB-INF/classes/doc/ReadJsonFile.html
     */
    readFile(fileId) {
        const file = this.fileList().findFile(fileId)[0];
        file.open();
        return this;
    }

    /**
     * &#x73FE;&#x5728;&#x958B;&#x3044;&#x3066;&#x3044;&#x308B;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3092;&#x4E0A;&#x66F8;&#x304D;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3059;&#x3002;
     *     newFile()&#x3055;&#x308C;&#x3066;&#x521D;&#x3081;&#x3066;&#x306E;&#x4FDD;&#x5B58;&#x306A;&#x3089;&#x540D;&#x524D;&#x3092;&#x3064;&#x3051;&#x3066;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3059;&#x3002;(&#x3068;&#x3082;&#x306B;&#x975E;&#x540C;&#x671F;&#x901A;&#x4FE1;)
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @see ../WEB-INF/classes/doc/WriteJsonFile.html
     */
    saveFile() {
        if (this.fileId() === -1) {
            this.saveAsFile(this.filename());
            return this;
        }

        this.announce(&apos;&#x4FDD;&#x5B58;&#x4E2D;&apos;);
        Util.post(&apos;/tategaki/WriteJsonFile&apos;,{
            user_id: this.userId(),
            file_id: this.fileId(),
            filename: this.filename(),
            json: this.data(),
            saved: Date.now()
        },function (json) {
            this.saved(json.strDate).announce(&apos;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3057;&#x305F;&apos;);
            this.fileList().read();
            this.isChanged(false);
        }.bind(this));
        return this;
    }

    /**
     * &#x73FE;&#x5728;&#x958B;&#x3044;&#x3066;&#x3044;&#x308B;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3092;&#x540D;&#x524D;&#x3092;&#x3064;&#x3051;&#x3066;&#x4FDD;&#x5B58;&#x3057;&#x307E;&#x3059;(&#x975E;&#x540C;&#x671F;&#x901A;&#x4FE1;)
     * @param {string} filename &#x65B0;&#x3057;&#x3044;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x306E;&#x540D;&#x524D;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     * @see ../WEB-INF/classes/doc/FileMaker.html
     * @see ../WEB-INF/classes/doc/WriteJsonFile.html
     */
    saveAsFile(filename) {
        Util.post(&apos;/tategaki/FileMaker&apos;,{
            user_id: this.userId(),
            filename: filename,
            saved: Date.now()
        },function (data) {
            this.filename(data.filename).fileId(data.newFileId);
            const file = new File(data.newFileId,data.filename);
            this.fileList().append(file).chainFile();
            this.saveFile();
        }.bind(this));
        return this;
    }

    /**
     * &#x65B0;&#x3057;&#x3044;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x3092;&#x958B;&#x304D;&#x307E;&#x3059;
     * @param {string=&apos;newfile&apos;} filename &#x65B0;&#x3057;&#x3044;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    newFile(filename) {
        if (filename === undefined) filename = &apos;newfile&apos;;
        this.init({
            fileId: -1,
            filename: filename,
            data: {
                conf:{},
                text:[[[],[]]]
            }
        }); // &#x7A7A;&#x6BB5;&#x843D;&#x306E;&#x30C7;&#x30FC;&#x30BF;
        return this;
    }//}}}

    // --Display&#x95A2;&#x4FC2; {{{
    /**
     * &#x6587;&#x66F8;&#x3092;&#xFF11;&#x884C;&#x76EE;&#x306E;&#xFF11;&#x6587;&#x5B57;&#x76EE;&#x304B;&#x3089;&#x8868;&#x793A;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    resetDisplay() {
        this.addDisplay(0,0);
        return this;
    }

    // strPos: &apos;center&apos;,&apos;right&apos;
    /**
     * &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x57FA;&#x6E96;&#x3068;&#x3057;&#x3066;&#x6587;&#x66F8;&#x3092;&#x8868;&#x793A;&#x3057;&#x76F4;&#x3057;&#x307E;&#x3059;
     * @param {string} [opt_pos] &#x8868;&#x793A;&#x5F8C;&#x306E;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x6307;&#x5B9A;&#x3059;&#x308B;&#x3002;&apos;center&apos;&#x3068;&apos;right&apos;&#x306B;&#x5BFE;&#x5FDC;&#x3002;
     *     &#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;&#x306F;&#x73FE;&#x5728;&#x306E;&#x8868;&#x793A;&#x4F4D;&#x7F6E;&#x304B;&#x3089;&#x6700;&#x4F4E;&#x9650;&#x306E;&#x79FB;&#x52D5;&#x3067;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x6587;&#x5B57;&#x304C;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x3088;&#x3046;&#x306B;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    changeDisplay(opt_pos) {
        const cursorChar = this.cursorChar();
        const rowPos = this.computeDisplayRowPos(opt_pos);
        const charPos = cursorChar.row().computeDisplayCharPos();
        this.addDisplay(rowPos,charPos);
        return this;
    }

    /**
     * firstRow&#x884C;&#x76EE;&#x4EE5;&#x964D;&#x3092;&#x8868;&#x793A;&#x3057;&#x307E;&#x3059;&#x3002;
     *     &#x6587;&#x5B57;&#x306F;firstChar&#x6587;&#x5B57;&#x76EE;&#x4EE5;&#x964D;&#x304C;&#x8868;&#x793A;&#x3055;&#x308C;&#x307E;&#x3059;
     * @param {number} firstRow &#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     * @param {number} firstChar &#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x6700;&#x521D;&#x306E;&#x6587;&#x5B57;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    addDisplay(firstRow,firstChar) {
        const dispWidth = this.width();
        const cache = {};
        let cnt = 0; // &#x7DCF;&#x884C;&#x6570;&#x3092;&#x30AB;&#x30A6;&#x30F3;&#x30C8;&#x3059;&#x308B;
        let sum = 0; // &#x8868;&#x793A;&#x884C;&#x306E;&#x5E45;&#x5408;&#x8A08;
        for (let paragraph of this.paragraphs()) {
            for (let row of paragraph.rows()) {
                if (cnt &lt; firstRow) {
                    row.display(false);
                    cnt++;
                    continue;
                }
                // &#x884C;&#x306E;&#x5E45;&#x306F;&#x5B50;&#x306E;&#x6700;&#x5927;&#x306E;&#x30D5;&#x30A9;&#x30F3;&#x30C8;&#x306B;&#x3088;&#x3063;&#x3066;&#x6C7A;&#x307E;&#x308B;&#x3068;&#x8003;&#x3048;&#x3001;&#x6700;&#x5927;&#x30D5;&#x30A9;&#x30F3;&#x30C8;&#x3054;&#x3068;&#x306E;&#x884C;&#x5E45;&#x3092;&#x30AD;&#x30E3;&#x30C3;&#x30B7;&#x30E5;&#x3059;&#x308B;(&#x30EC;&#x30F3;&#x30C0;&#x30EA;&#x30F3;&#x30B0;&#x983B;&#x5EA6;&#x306E;&#x524A;&#x6E1B;)
                const maxFont = row.maxFont();
                if (cache[maxFont]) {
                    const rowWidth = cache[maxFont];
                    sum += rowWidth + 2; // 2&#x306F;&#x30DC;&#x30FC;&#x30C0;&#x30FC;&#x306E;&#x5E45;
                } else {
                    cache[maxFont] = row.width();
                    const rowWidth = cache[maxFont];
                    sum += rowWidth + 2; // 2&#x306F;&#x30DC;&#x30FC;&#x30C0;&#x30FC;&#x306E;&#x5E45;
                }
                row.display((sum &lt; dispWidth),firstChar);
                cnt++;
            }
        }
        return this;
    }

    /**
     * @private
     * &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x57FA;&#x6E96;&#x306B;&#x3001;&#x6700;&#x521D;&#x306B;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x3079;&#x304D;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @param {string} [opt_pos] &#x8868;&#x793A;&#x5F8C;&#x306E;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x6307;&#x5B9A;&#x3059;&#x308B;&#x3002;&apos;center&apos;&#x306A;&#x3089;&#x3001;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x4E2D;&#x592E;&#x306B;&#x3059;&#x308B;&#x3002;&apos;right&apos;&#x306A;&#x3089;&#x3001;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x304C;&#x6700;&#x3082;&#x53F3;&#x306B;&#x306A;&#x308B;&#x3088;&#x3046;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x3002;
     *     &#x7701;&#x7565;&#x3057;&#x305F;&#x5834;&#x5408;&#x306F;&#x73FE;&#x5728;&#x306E;&#x8868;&#x793A;&#x4F4D;&#x7F6E;&#x304B;&#x3089;&#x6700;&#x4F4E;&#x9650;&#x306E;&#x79FB;&#x52D5;&#x3067;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x6587;&#x5B57;&#x304C;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x3088;&#x3046;&#x306B;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;
     * @return {number} &#x8A08;&#x7B97;&#x3055;&#x308C;&#x305F;&#x6700;&#x521D;&#x306B;&#x8868;&#x793A;&#x3055;&#x308C;&#x308B;&#x3079;&#x304D;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;
     */
    computeDisplayRowPos(opt_pos) {
        const currentFirst = this.firstDisplayRowPos();
        const cursorIndex = this.cursorRowPos();
        const currentEnd = this.lastDisplayRowPos();

        // &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x4F4D;&#x7F6E;&#x3092;&#x4E2D;&#x592E;&#x306B;&#x3059;&#x308B;
        // HACK:&#x8A08;&#x7B97;&#x524D;&#x306E;display&#x306E;&#x6570;&#x3092;&#x57FA;&#x6E96;&#x306B;&#x3059;&#x308B;&#x306E;&#x3067;&#x3001;&#x30D5;&#x30A9;&#x30F3;&#x30C8;&#x306E;&#x5927;&#x304D;&#x3055;&#x306A;&#x3069;&#x306B;&#x3088;&#x3063;&#x3066;&#x305A;&#x308C;&#x3082;&#x3042;&#x308A;&#x3046;&#x308B;
        if (opt_pos === &apos;center&apos;) {
            const harfRange = (currentEnd - currentFirst)/2;
            const ret = cursorIndex - harfRange;
            return ret &gt;= 0 ? ret : 0;
        }
        if (opt_pos === &apos;right&apos;) {
            return cursorIndex;
        }

        // &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x304C;&#x524D;&#x306B;&#x3042;&#x308B;
        if (cursorIndex &lt; currentFirst) {
            return cursorIndex;
        }
        // &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x304C;&#x5F8C;&#x308D;&#x306B;&#x3042;&#x308B;
        if (cursorIndex &gt; currentEnd) {
            return currentFirst + (cursorIndex - currentEnd);
        }
        // display&#x306B;&#x56F2;&#x307E;&#x308C;&#x305F;&#x90E8;&#x5206;&#x306B;display&#x3067;&#x306A;&#x3044;&#x884C;&#x304C;&#x3042;&#x308B;&#x5834;&#x5408;
        // &#x9014;&#x4E2D;&#x884C;&#x6570;&#x5909;&#x5316;
        return currentFirst;
    }

    /**
     * @private
     * &#x73FE;&#x5728;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {number} &#x73FE;&#x5728;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3002;&#x8868;&#x793A;&#x884C;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;-1
     */
    firstDisplayRowPos() {
        let cnt = 0;
        for (let paragraph of this.paragraphs()) {
            for (let row of paragraph.rows()) {
                if (row.isDisplay())
                    return cnt;
                cnt++;
            }
        }
        return -1;
    }

    /**
     * @private
     * &#x73FE;&#x5728;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x6700;&#x5F8C;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {number} &#x73FE;&#x5728;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x6700;&#x5F8C;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3002;&#x8868;&#x793A;&#x884C;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;-1
     */
    lastDisplayRowPos() {
        for (let row = this.lastRow(),cnt = this.countRow() -1; row; row = row.prev(),cnt--)
            if (row.isDisplay()) return cnt;
        return -1;
    }

    /**
     * @private
     * &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x884C;&#x306E;&#x6587;&#x66F8;&#x5168;&#x4F53;&#x3067;&#x4F55;&#x884C;&#x76EE;&#x304B;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {number} &#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x884C;&#x306E;&#x6587;&#x66F8;&#x5168;&#x4F53;&#x3067;&#x306E;&#x30A4;&#x30F3;&#x30C7;&#x30C3;&#x30AF;&#x30B9;&#x3002;&#x6587;&#x66F8;&#x5185;&#x306B;&#x6BB5;&#x843D;&#x304C;&#x306A;&#x3044;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x884C;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;-1
     */
    cursorRowPos() {
        const cursorRow = this.cursor().getChar().row();
        let cnt = 0;
        for (let paragraph of this.paragraphs()) {
            for (let row of paragraph.rows()) {
                if (row.is(cursorRow))
                    return cnt;
                cnt++;
            }
        }
        return -1;
    }

    /**
     * @private
     * &#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x3046;&#x3061;&#x6700;&#x521D;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Row} &#x6700;&#x521D;&#x306E;&#x8868;&#x793A;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3002;&#x8868;&#x793A;&#x884C;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;null
     */
    firstDisplayRow() {
        for (let paragraph of this.paragraphs())
            for (let row of paragraph.rows())
            if (row.isDisplay()) return row;
        return null;
    }

    /**
     * @private
     * &#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x884C;&#x306E;&#x3046;&#x3061;&#x6700;&#x5F8C;&#x306E;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;
     * @return {Row} &#x6700;&#x5F8C;&#x306E;&#x8868;&#x793A;&#x884C;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x3002;&#x8868;&#x793A;&#x884C;&#x304C;&#x306A;&#x3051;&#x308C;&#x3070;null
     */
    lastDisplayRow() {
        for (let row = this.lastRow(); row; row = row.prev())
            if (row.isDisplay()) return row;
        return null;
    }

    /**
     * &#x8868;&#x793A;&#x3092;&#x4E00;&#x884C;&#x5206;&#x53F3;&#x306B;&#x52D5;&#x304B;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    shiftRightDisplay() {
        const charPos = this.cursorRow().computeDisplayCharPos();
        const firstDisplay = this.firstDisplayRow();
        if (!firstDisplay.prev()) return this;
        firstDisplay.prev().display(true,charPos);
        this.lastDisplayRow().display(false);
        return this;
    }

    /**
     * &#x8868;&#x793A;&#x3092;&#x4E00;&#x884C;&#x5206;&#x5DE6;&#x306B;&#x52D5;&#x304B;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    shiftLeftDisplay() {
        const charPos = this.cursorRow().computeDisplayCharPos();
        const lastDisplay = this.lastDisplayRow();
        if (!lastDisplay.next()) return this;
        lastDisplay.next().display(true,charPos);
        this.firstDisplayRow().display(false);
        return this;
    } //}}}

    // undo redo {{{
    /**
     * DoMemory&#x3092;&#x30A2;&#x30F3;&#x30C9;&#x30A5;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x306B;&#x7A4D;&#x307F;&#x307E;&#x3059;
     * @param {DoMemory} doMemory &#x30A2;&#x30F3;&#x30C9;&#x30A5;&#x30B9;&#x30BF;&#x30C3;&#x30AF;&#x306B;&#x7A4D;&#x3080;DoMemory
     */
    addDo(doMemory) {
        this._doManager.add(doMemory);
        return this;
    }

    /**
     * &#x30A2;&#x30F3;&#x30C9;&#x30A5;&#x3057;&#x307E;&#x3059;
     */
    undo() {
        if (this._doManager.hasUndo())
            this._doManager.undo();
        else
            this.announce(&apos;&#x3059;&#x3067;&#x306B;&#x4E00;&#x756A;&#x53E4;&#x3044;&#x5909;&#x66F4;&#x3067;&#x3059;&apos;);
        return this;
    }

    /**
     * &#x30EA;&#x30C9;&#x30A5;&#x3057;&#x307E;&#x3059;
     */
    redo() {
        if (this._doManager.hasRedo())
            this._doManager.redo();
        else
            this.announce(&apos;&#x3059;&#x3067;&#x306B;&#x4E00;&#x756A;&#x65B0;&#x3057;&#x3044;&#x5909;&#x66F4;&#x3067;&#x3059;&apos;);
        return this;
    }//}}}

    // --&#x30A4;&#x30D9;&#x30F3;&#x30C8; {{{
    // keydown
    /**
     * &#x3053;&#x306E;&#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x306B;keydown&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x30EA;&#x30B9;&#x30CA;&#x30FC;&#x3092;&#x4ED8;&#x52A0;&#x3057;&#x307E;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    addKeydownEventListener() {
        this.inputBuffer().removeKeydownEventListener()
            .convertContainer().removeKeydownEventListener();
        super.addKeydownEventListener();
        return this;
    }

    /**
     * keydown&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x306E;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3067;&#x3059;
     * @param {Event} e &#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     * @param {number} keycode &#x62BC;&#x4E0B;&#x3055;&#x308C;&#x305F;&#x30AD;&#x30FC;&#x306E;&#x30AD;&#x30FC;&#x30B3;&#x30FC;&#x30C9;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    runKeydown(e,keycode) {
        this.announce(&apos;&apos;);
        if (e.ctrlKey) return this.runControlKeyDown(e,keycode);

        switch (keycode) {
            case 8:
                // backspace
                this.cursor().backSpace(true);
                break;
            case 13:
                // Enter
                this.cursor().lineBreak(true);
                break;
            case 32:
                // space
                this.cursor().insert(&apos;&#x3000;&apos;, true);
                break;
            case 37:
                // Left
                this.cursor().moveLeft(e.shiftKey);
                break;
            case 38:
                // Up
                this.cursor().movePrev(e.shiftKey);
                break;
            case 39:
                // Right
                this.cursor().moveRight(e.shiftKey);
                break;
            case 40:
                // Down
                this.cursor().moveNext(e.shiftKey);
                break;
            case 58: // firefox developer edition
            case 186: // chrome
                // :
                this.command().start();
                break;
            case 191:
                // /
                this.startSearchMode();
                break;
            default:
                this.inputBuffer().tryTransfer(keycode,e.shiftKey);
                break;
        }
        return this;
    }

    /**
     * @private
     * &#x30B3;&#x30F3;&#x30C8;&#x30ED;&#x30FC;&#x30EB;&#x30AD;&#x30FC;&#x3092;&#x62BC;&#x3055;&#x308C;&#x3066;&#x3044;&#x305F;&#x5834;&#x5408;&#x306E;keydown&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x306E;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3067;&#x3059;
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    runControlKeyDown(e,keycode) {
        console.log(&apos;keycode&apos;, keycode);
        switch (keycode) {
            case 67:
                // c
                this.copySelectText();
                break;
            case 18:
            case 70:
                // f
                this.fileList().showModal();
                break;
            case 72:
                // h
                this.cursor().moveLeft(e.shiftKey);
                break;
            case 73:
                // i
                this.fileList().openNextFile();
                break;
            case 74:
                // j
                this.cursor().moveNext(e.shiftKey);
                break;
            case 75:
                // k
                this.cursor().movePrev(e.shiftKey);
                break;
            case 76:
                // l
                this.cursor().moveRight(e.shiftKey);
                break;
            case 79:
                // o
                this.fileList().openPrevFile();
                break;
            case 82:
                //r
                this.redo();
                break;
            case 83:
                // s
                this.saveFile();
                break;
            case 85:
                //u
                this.undo();
                break;
            case 86:
                // v
                this.pasteText();
                break;
            case 188:
                // ,
                this.cursor().nextSearch();
                break;
            case 190:
                // .
                this.cursor().prevSearch();
                break;
            default:
                break;
        }
        return this;
    }

    // wheel
    /**
     * &#x30DB;&#x30A4;&#x30FC;&#x30EB;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x306E;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3067;&#x3059;(&#x8868;&#x793A;&#x3092;&#xFF14;&#x884C;&#x5206;&#x79FB;&#x52D5;&#x3059;&#x308B;)
     * @param {Event} e &#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     * @param {boolean} isUp &#x4E0A;&#x65B9;&#x5411;&#x306B;&#x30DB;&#x30A4;&#x30FC;&#x30EB;&#x304C;&#x52D5;&#x304B;&#x3055;&#x308C;&#x305F;&#x306A;&#x3089;true&#x3001;&#x305D;&#x3046;&#x3067;&#x306A;&#x3051;&#x308C;&#x3070;false
     * @return {SentenceContainer} &#x81EA;&#x8EAB;&#x306E;&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;
     */
    runWheel(e,isUp) {
        const mvRowNum = 4; // &#x4E00;&#x5EA6;&#x306B;&#x52D5;&#x304B;&#x3059;&#x884C;&#x6570;
        if (isUp)
            for (let i = 0; i &lt; mvRowNum; i++)
            this.shiftRightDisplay();
        else
            for (let i = 0; i &lt; mvRowNum; i++)
            this.shiftLeftDisplay();
        return this;
    }

    // &#x8A9E;&#x53E5;&#x691C;&#x7D22;
    /**
     * &#x8A9E;&#x53E5;&#x691C;&#x7D22;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306E;keyup&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x3067;&#x3059;
     * @param {Event} e &#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
     */
    onKeyupOnSearchMode(e) {
        let keycode;
        if (document.all) {
            // IE
            keycode = e.keyCode;
        } else {
            // IE&#x4EE5;&#x5916;
            keycode = e.which;
        }
        if (keycode === 13) {
            // enter
            this.searchInputElem().blur(); // enter&#x3092;&#x62BC;&#x3057;&#x305F;&#x3060;&#x3051;&#x3067;&#x306F;&#x30D5;&#x30A9;&#x30FC;&#x30AB;&#x30B9;&#x304C;&#x5916;&#x308C;&#x306A;&#x3044;
            return;
        }

        // &#x4E2D;&#x8EAB;&#x304C;&#x7A7A;&#x306B;&#x306A;&#x308C;&#x3070;search&#x30E2;&#x30FC;&#x30C9;&#x3092;&#x5B8C;&#x5168;&#x306B;&#x7D42;&#x4E86;&#x3059;&#x308B;
        if (this.searchInputElem().value === &apos;&apos;) {
            this.searchInputElem().blur();
            this.stopSearchMode();
            return;
        }

        this.search(this.searchInputElem().value.slice(1));
    }

    /**
     * &#x8A9E;&#x53E5;&#x691C;&#x7D22;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x304B;&#x3089;&#x30D5;&#x30A9;&#x30FC;&#x30AB;&#x30B9;&#x304C;&#x5916;&#x308C;&#x305F;&#x969B;&#x306E;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3067;&#x3059;&#x3002;
     *     &#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x672C;&#x4F53;&#x306B;keydown&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x3092;&#x623B;&#x3057;&#x307E;&#x3059;
     */
    onFocusoutOnSearchMode() {
        this.addKeydownEventListener();
    }

    /**
     * &#x8A9E;&#x53E5;&#x691C;&#x7D22;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306B;&#x30D5;&#x30A9;&#x30FC;&#x30AB;&#x30B9;&#x304C;&#x3042;&#x305F;&#x3063;&#x305F;&#x969B;&#x306E;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3067;&#x3059;&#x3002;
     *     &#x6587;&#x66F8;&#x30B3;&#x30F3;&#x30C6;&#x30CA;&#x672C;&#x4F53;&#x306E;keydown&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x3092;&#x5916;&#x3057;&#x307E;&#x3059;
     */
    onFocusinOnSearchMode() {
        this.removeKeydownEventListener();
    }

    // &#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;input
    /**
     * &#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;input&#x30D5;&#x30A9;&#x30FC;&#x30E0;&#x306B;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x3092;&#x4ED8;&#x52A0;&#x3057;&#x307E;&#x3059;(&#x4E3B;&#x306B;&#x3001;&#x30D5;&#x30A9;&#x30FC;&#x30AB;&#x30B9;&#x304C;&#x3042;&#x305F;&#x3063;&#x305F;&#x969B;&#x3068;&#x5916;&#x308C;&#x305F;&#x969B;&#x306E;&#x30A4;&#x30D9;&#x30F3;&#x30C8;)&#x3002;
     */
    addFileTitleEvent() {
        // &#x4E0E;&#x3048;&#x3063;&#x3071;&#x306A;&#x3057;&#x3002;&#x5B9F;&#x884C;&#x5185;&#x5BB9;&#x3082;&#x3053;&#x3053;&#x3067;&#x5B9A;&#x7FA9;
        this.titleElem().addEventListener(&apos;focusin&apos;,function (e) {
            if (this.inputBuffer().isDisplay) this.inputBuffer().empty().hide();
            this.removeKeydownEventListener();
        }.bind(this),false);

        this.titleElem().addEventListener(&apos;focusout&apos;,function (e) {
            if (this.titleElem().value === &apos;&apos;) {
                this.announce(&apos;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x540D;&#x304C;&#x5165;&#x529B;&#x3055;&#x308C;&#x3066;&#x3044;&#x307E;&#x305B;&#x3093;&apos;,&apos;red&apos;);
                this.titleElem().value = this.titleElem().dataset.filename;
            }
            this.addKeydownEventListener();
        }.bind(this),false);
    }

    // selection
    /**
     * &#x30DE;&#x30A6;&#x30B9;&#x3067;&#x9078;&#x629E;&#x7BC4;&#x56F2;&#x3092;&#x5909;&#x66F4;&#x3057;&#x305F;&#x969B;&#x306E;&#x30A4;&#x30D9;&#x30F3;&#x30C8;&#x3092;&#x4E0E;&#x3048;&#x307E;&#x3059;&#x3002;&#x9078;&#x629E;&#x7BC4;&#x56F2;&#x6700;&#x5F8C;&#x306E;&#x6587;&#x5B57;&#x306E;&#x6B21;&#x306E;&#x6587;&#x5B57;&#x306B;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x3092;&#x5F53;&#x3066;&#x307E;&#x3059;
     */
    addSelectEvent() {
        this.elem().addEventListener(&apos;mouseup&apos;,function (e) {
            const selChars = this.selectChars();
            // &#x9078;&#x629E;&#x7BC4;&#x56F2;&#x306E;&#x76F4;&#x5F8C;&#x306B;&#x30AB;&#x30FC;&#x30BD;&#x30EB;&#x3092;&#x5F53;&#x3066;&#x308B;
            if (selChars.length &gt; 0) {
                const lastCharOnSelect = selChars[selChars.length -1];
                const newCursor = lastCharOnSelect.hasNextSibling() ? lastCharOnSelect.next() : lastCharOnSelect;
                newCursor.addCursor().setPosMemory();
            }
        }.bind(this),false);
    }
    //}}}
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
